import{g as B,r as D,c as L,h as T,F,i as N,u as H,o as O,n as S,_ as U}from"./index-CEEn8P2q.js";if(!z)var z={map:function(l,a){var d={};return a?l.map(function(v,h){return d.index=h,a.call(d,v)}):l.slice()},naturalOrder:function(l,a){return l<a?-1:l>a?1:0},sum:function(l,a){var d={};return l.reduce(a?function(v,h,m){return d.index=m,v+a.call(d,h)}:function(v,h){return v+h},0)},max:function(l,a){return Math.max.apply(null,a?z.map(l,a):l)}};var j=function(){var l=5,a=8-l,d=1e3;function v(e,t,o){return(e<<2*l)+(t<<l)+o}function h(e){var t=[],o=!1;function u(){t.sort(e),o=!0}return{push:function(n){t.push(n),o=!1},peek:function(n){return o||u(),n===void 0&&(n=t.length-1),t[n]},pop:function(){return o||u(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return o||u(),t}}}function m(e,t,o,u,n,r,f){var s=this;s.r1=e,s.r2=t,s.g1=o,s.g2=u,s.b1=n,s.b2=r,s.histo=f}function x(){this.vboxes=new h(function(e,t){return z.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function y(e,t){if(t.count()){var o=t.r2-t.r1+1,u=t.g2-t.g1+1,n=z.max([o,u,t.b2-t.b1+1]);if(t.count()==1)return[t.copy()];var r,f,s,c,g=0,p=[],b=[];if(n==o)for(r=t.r1;r<=t.r2;r++){for(c=0,f=t.g1;f<=t.g2;f++)for(s=t.b1;s<=t.b2;s++)c+=e[v(r,f,s)]||0;p[r]=g+=c}else if(n==u)for(r=t.g1;r<=t.g2;r++){for(c=0,f=t.r1;f<=t.r2;f++)for(s=t.b1;s<=t.b2;s++)c+=e[v(f,r,s)]||0;p[r]=g+=c}else for(r=t.b1;r<=t.b2;r++){for(c=0,f=t.r1;f<=t.r2;f++)for(s=t.g1;s<=t.g2;s++)c+=e[v(f,s,r)]||0;p[r]=g+=c}return p.forEach(function(w,_){b[_]=g-w}),function(w){var _,C,M,q,k,I=w+"1",E=w+"2",$=0;for(r=t[I];r<=t[E];r++)if(p[r]>g/2){for(M=t.copy(),q=t.copy(),k=(_=r-t[I])<=(C=t[E]-r)?Math.min(t[E]-1,~~(r+C/2)):Math.max(t[I],~~(r-1-_/2));!p[k];)k++;for($=b[k];!$&&p[k-1];)$=b[--k];return M[E]=k,q[I]=M[E]+1,[M,q]}}(n==o?"r":n==u?"g":"b")}}return m.prototype={volume:function(e){var t=this;return t._volume&&!e||(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(e){var t=this,o=t.histo;if(!t._count_set||e){var u,n,r,f=0;for(u=t.r1;u<=t.r2;u++)for(n=t.g1;n<=t.g2;n++)for(r=t.b1;r<=t.b2;r++)f+=o[v(u,n,r)]||0;t._count=f,t._count_set=!0}return t._count},copy:function(){var e=this;return new m(e.r1,e.r2,e.g1,e.g2,e.b1,e.b2,e.histo)},avg:function(e){var t=this,o=t.histo;if(!t._avg||e){var u,n,r,f,s=0,c=1<<8-l,g=0,p=0,b=0;for(n=t.r1;n<=t.r2;n++)for(r=t.g1;r<=t.g2;r++)for(f=t.b1;f<=t.b2;f++)s+=u=o[v(n,r,f)]||0,g+=u*(n+.5)*c,p+=u*(r+.5)*c,b+=u*(f+.5)*c;t._avg=s?[~~(g/s),~~(p/s),~~(b/s)]:[~~(c*(t.r1+t.r2+1)/2),~~(c*(t.g1+t.g2+1)/2),~~(c*(t.b1+t.b2+1)/2)]}return t._avg},contains:function(e){var t=this,o=e[0]>>a;return gval=e[1]>>a,bval=e[2]>>a,o>=t.r1&&o<=t.r2&&gval>=t.g1&&gval<=t.g2&&bval>=t.b1&&bval<=t.b2}},x.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,o=0;o<t.size();o++)if(t.peek(o).vbox.contains(e))return t.peek(o).color;return this.nearest(e)},nearest:function(e){for(var t,o,u,n=this.vboxes,r=0;r<n.size();r++)((o=Math.sqrt(Math.pow(e[0]-n.peek(r).color[0],2)+Math.pow(e[1]-n.peek(r).color[1],2)+Math.pow(e[2]-n.peek(r).color[2],2)))<t||t===void 0)&&(t=o,u=n.peek(r).color);return u},forcebw:function(){var e=this.vboxes;e.sort(function(n,r){return z.naturalOrder(z.sum(n.color),z.sum(r.color))});var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var o=e.length-1,u=e[o].color;u[0]>251&&u[1]>251&&u[2]>251&&(e[o].color=[255,255,255])}},{quantize:function(e,t){if(!e.length||t<2||t>256)return!1;var o=function(c){var g,p=new Array(1<<3*l);return c.forEach(function(b){g=v(b[0]>>a,b[1]>>a,b[2]>>a),p[g]=(p[g]||0)+1}),p}(e);o.forEach(function(){});var u=function(c,g){var p,b,w,_=1e6,C=0,M=1e6,q=0,k=1e6,I=0;return c.forEach(function(E){(p=E[0]>>a)<_?_=p:p>C&&(C=p),(b=E[1]>>a)<M?M=b:b>q&&(q=b),(w=E[2]>>a)<k?k=w:w>I&&(I=w)}),new m(_,C,M,q,k,I,g)}(e,o),n=new h(function(c,g){return z.naturalOrder(c.count(),g.count())});function r(c,g){for(var p,b=c.size(),w=0;w<d;){if(b>=g||w++>d)return;if((p=c.pop()).count()){var _=y(o,p),C=_[0],M=_[1];if(!C)return;c.push(C),M&&(c.push(M),b++)}else c.push(p),w++}}n.push(u),r(n,.75*t);for(var f=new h(function(c,g){return z.naturalOrder(c.count()*c.volume(),g.count()*g.volume())});n.size();)f.push(n.pop());r(f,t);for(var s=new x;f.size();)s.push(f.pop());return s}}}().quantize,A=function(l){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.width=this.canvas.width=l.naturalWidth,this.height=this.canvas.height=l.naturalHeight,this.context.drawImage(l,0,0,this.width,this.height)};A.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};var P=function(){};P.prototype.getColor=function(l,a){return a===void 0&&(a=10),this.getPalette(l,5,a)[0]},P.prototype.getPalette=function(l,a,d){var v=function(y){var e=y.colorCount,t=y.quality;if(e!==void 0&&Number.isInteger(e)){if(e===1)throw new Error("colorCount should be between 2 and 20. To get one color, call getColor() instead of getPalette()");e=Math.max(e,2),e=Math.min(e,20)}else e=10;return(t===void 0||!Number.isInteger(t)||t<1)&&(t=10),{colorCount:e,quality:t}}({colorCount:a,quality:d}),h=new A(l),m=function(y,e,t){for(var o,u,n,r,f,s=y,c=[],g=0;g<e;g+=t)u=s[0+(o=4*g)],n=s[o+1],r=s[o+2],((f=s[o+3])===void 0||f>=125)&&(u>250&&n>250&&r>250||c.push([u,n,r]));return c}(h.getImageData().data,h.width*h.height,v.quality),x=j(m,v.colorCount);return x?x.palette():null},P.prototype.getColorFromUrl=function(l,a,d){var v=this,h=document.createElement("img");h.addEventListener("load",function(){var m=v.getPalette(h,5,d);a(m[0],l)}),h.src=l},P.prototype.getImageData=function(l,a){var d=new XMLHttpRequest;d.open("GET",l,!0),d.responseType="arraybuffer",d.onload=function(){if(this.status==200){var v=new Uint8Array(this.response);i=v.length;for(var h=new Array(i),m=0;m<v.length;m++)h[m]=String.fromCharCode(v[m]);var x=h.join(""),y=window.btoa(x);a("data:image/png;base64,"+y)}},d.send()},P.prototype.getColorAsync=function(l,a,d){var v=this;this.getImageData(l,function(h){var m=document.createElement("img");m.addEventListener("load",function(){var x=v.getPalette(m,5,d);a(x[0],this)}),m.src=h})};const G={class:"grid"},R=["src","onMouseenter"],V=B({__name:"colorThief",setup(l){const a=new P;let d=D([]),v=D(null);for(let y=0;y<4;y++)d.value.push(`https://picsum.photos/500/500?random=${y}`);const h=D(-1),m=async(y,e)=>{h.value=e;let t=await a.getPalette(y,3);t=t.map(o=>`rgb(${o[0]},${o[1]},${o[2]})`),v.value.style.setProperty("background",`linear-gradient(to right, ${t[0]}, ${t[1]},${t[2]})`)},x=()=>{h.value=-1,v.value.style.setProperty("background","#fff")};return(y,e)=>(O(),L("div",{class:"palette_container",ref_key:"palette",ref:v},[e[0]||(e[0]=T("span",{style:{color:"#000"}},"颜色截取动态替换 colorThief",-1)),e[1]||(e[1]=T("br",null,null,-1)),T("div",G,[(O(!0),L(F,null,N(H(d),(t,o)=>(O(),L("div",{class:"item",key:o},[T("img",{crossorigin:"anonymous",src:t,alt:"",onMouseenter:u=>m(u.target,o),onMouseleave:x,style:S({opacity:h.value===-1||o===h.value?1:.2,transition:"0.5s"})},null,44,R)]))),128))])],512))}}),X=U(V,[["__scopeId","data-v-b3e9697b"]]);export{X as default};
